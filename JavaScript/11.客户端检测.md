# 客户端检测

## 能力检测

能力检测即特性检测，不需要知道特定浏览器的信息，只需检测自己关心的能力是否存在即可

```js
function getElement(id){
	if(document.getElementById){
		return document.getElementById(id)
	}else if(document.all){ // IE5以前用document.all来模拟getElementById
		return document.all[id]
	}else{
		throw new Error('No way to retrieve element')
	}
}
```

### 安全能力检测

能力检测最有效的场景是**检测能力是否存在的同时，验证其是否能够展现出预期的行为**

```js
function isSortable(object){
    // 不要这样做，这样只能检测对象有没有sort属性，但是不能检测sort是否符合预期行为
	return !!object.sort;
}
let result = isSortable({sort: true}) // 这样也能返回true

function isSortable(object){
    // 这样能检测对象的sort属性是否是函数类型
    return typeof object.sort == 'function'
}
```

### 基于能力检测进行浏览器分析

使用能力检测而非用户代理检测的有点在于，伪造用户代理字符串很简单，但伪造相应的能力很难

#### 特性检测

按照能力将浏览器归类，最好集中检测

```js
// 检测浏览器是否支持Netscape式插件
let hasNSPlugins = !!(navigator.plugins&&navigator.plugins.length)

// 检测浏览器是否具有DOM level1能力
let hasDOM1 = !!(document.getElementById && document.createElement && document.getElementByTagName)
```

